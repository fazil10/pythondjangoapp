import asyncio
from lib2to3.pygram import Symbols
import ssl
from symtable import Symbol
# import time
from unittest import result
from urllib import response
# import aiohttp
# import asyncio
import os
import aiohttp

from requests import session

api_key = os.getenv('ALPHAVANTAGE_API_KEY')
url = 'https://www.alphavantage.co/query?function=OVERVIEW&symbol={}&apikey={}'
symbol = ['as','sa','sadsa','asdas']
results = []

start = time.time()

async def getsymbols():
   async with aiohttp.ClientSession() as session:
        for symbol in symbols:
            print('working on symbols {}'.format(symbol))
            response =await session.get(url.format(symbol,api_key),ssl = False)
            results.append(await response.json())

# getsymbols()

asyncio.run(getsymbols())

# loop = asyncio.get_event_loop()
# loop.run_until_complete(getsymbols())
# loop.close()



end = time.time()
total_time = end -start
print("took {} second make {} api calls".format(total_time,len(symbol)))
print('great work')
    
